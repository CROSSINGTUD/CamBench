name:
  ECB Mode Filed-Sensitive Case 1

api:
  - javax.crypto.Cipher

description:
  Two configurations of the AES algorithm are stored in an objects fields. 
  One contains the secure CBC mode of operation, the other the insecure ECB mode. 
  The latter one is then used to initialize an instance of the AES cipher.

violations:
  - argument_state/string_format

location:
  root:
    file: main/java/org/cambench/cap/fieldsensitivity/ecbmode/EcbMode1.java
    method: main(string[] args)
    line: 12
  misuse:
    file: main/java/org/cambench/cap/fieldsensitivity/ecbmode/EcbMode1.java
    method: main(string[] args)
    line: 17

fix:
  description:
    Do not utilize the ECB mode of operation. Instead, use a more secure mode, like CBC.
  file: main/java/org/cambench/cap/fieldsensitivity/ecbmode/CorrectedEcbMode.java

complexity: 1

capabilities: field-sensitivity

context: relevant